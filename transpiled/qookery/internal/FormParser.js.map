{
  "version": 3,
  "sources": [
    "/home/travis/build/cboulanger/eventrecorder/contrib/ergobyte_qookery_v0.7.0-pre/qookery/source/class/qookery/internal/FormParser.js"
  ],
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "implement",
    "qookery",
    "IFormParser",
    "statics",
    "__REGISTRY",
    "internal",
    "Registry",
    "getInstance",
    "construct",
    "variables",
    "serviceResolver",
    "assertMap",
    "assertFunction",
    "__variables",
    "__serviceResolver",
    "members",
    "parseXmlDocument",
    "xmlDocument",
    "parentComponent",
    "Error",
    "component",
    "__parseStatementBlock",
    "blockElement",
    "dom",
    "Element",
    "hasChildren",
    "selectionMade",
    "Hierarchy",
    "getChildElements",
    "reduce",
    "previousResult",
    "statementElement",
    "elementQName",
    "Node",
    "getName",
    "lang",
    "String",
    "format",
    "getText",
    "namespaces",
    "util",
    "Xml",
    "getNamespaceDeclarations",
    "elementName",
    "resolveQName",
    "prefix",
    "namespaceUri",
    "resolveNamespacePrefix",
    "constructor",
    "isComponentTypeAvailable",
    "__parseComponent",
    "__parseIfElse",
    "__parseScript",
    "__parseSwitch",
    "__parseXInclude",
    "parseXmlElement",
    "bind",
    "componentElement",
    "componentName",
    "createComponent",
    "componentId",
    "getAttribute",
    "setAttribute",
    "IComponent",
    "A_ID",
    "A_NAMESPACES",
    "implementsInterface",
    "IFormComponent",
    "A_SERVICE_RESOLVER",
    "A_VARIABLES",
    "translationPrefix",
    "A_TRANSLATION_PREFIX",
    "getForm",
    "putComponent",
    "attributes",
    "parseAllAttributes",
    "useAttributes",
    "split",
    "forEach",
    "variableName",
    "getVariable",
    "Type",
    "isObject",
    "mergeWith",
    "create",
    "setup",
    "display",
    "hasInterface",
    "IContainerComponent",
    "add",
    "c",
    "dispose",
    "xIncludeElement",
    "formUrl",
    "parseValue",
    "xmlString",
    "Qookery",
    "getService",
    "loadResource",
    "xml",
    "Document",
    "fromString",
    "formParser",
    "FormParser",
    "xmlIdAttribute",
    "value",
    "e",
    "error",
    "selectionElement",
    "expression",
    "result",
    "evaluateExpression",
    "mediaQuery",
    "query",
    "__getMediaQuery",
    "isMatching",
    "language",
    "locale",
    "Manager",
    "getLanguage",
    "scriptElement",
    "sourceCode",
    "getNodeText",
    "scriptUrl",
    "functionConstructorArgs",
    "argumentNames",
    "Array",
    "prototype",
    "push",
    "apply",
    "scriptFunction",
    "Function",
    "truncate",
    "message",
    "actionNames",
    "functionNames",
    "eventNames",
    "onlyOnce",
    "preventRecursion",
    "debounceMillis",
    "parseInt",
    "execute",
    "componentIds",
    "components",
    "map",
    "getComponent",
    "componentFunction",
    "isDisposed",
    "__isRunning",
    "scriptArguments",
    "slice",
    "call",
    "arguments",
    "unshift",
    "getScriptingContext",
    "Debug",
    "logScriptError",
    "toString",
    "debounceFunction",
    "timerId",
    "__timerId",
    "clearTimeout",
    "bindArguments",
    "setTimoutFunction",
    "setTimeout",
    "methodName",
    "listenerId",
    "data",
    "addToDisposeList",
    "removeListenerById",
    "functionName",
    "actionName",
    "setAction",
    "eventName",
    "addEventHandler",
    "varargs",
    "log",
    "Logger",
    "switchElement",
    "switchExpression",
    "switchResult",
    "children",
    "i",
    "length",
    "caseElement",
    "caseExpression",
    "caseResult",
    "getMediaQuery",
    "bom",
    "MediaQuery"
  ],
  "mappings": "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",
  "file": "FormParser.js",
  "sourcesContent": [
    "/*\n\tQookery - Declarative UI Building for Qooxdoo\n\n\tCopyright (c) Ergobyte Informatics S.A., www.ergobyte.gr\n\n\tLicensed under the Apache License, Version 2.0 (the \"License\");\n\tyou may not use this file except in compliance with the License.\n\tYou may obtain a copy of the License at\n\n\t\thttp://www.apache.org/licenses/LICENSE-2.0\n\n\tUnless required by applicable law or agreed to in writing, software\n\tdistributed under the License is distributed on an \"AS IS\" BASIS,\n\tWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n\tSee the License for the specific language governing permissions and\n\tlimitations under the License.\n*/\n\n/**\n * The FormParser will parse a form XML document to create\n * a fully populated IFormComponent into a container composite\n */\nqx.Class.define(\"qookery.internal.FormParser\", {\n\n\textend: qx.core.Object,\n\timplement: [ qookery.IFormParser ],\n\n\tstatics: {\n\n\t\t__REGISTRY: qookery.internal.Registry.getInstance()\n\t},\n\n\tconstruct: function(variables, serviceResolver) {\n\t\tthis.base(arguments);\n\t\tif(qx.core.Environment.get(\"qx.debug\")) {\n\t\t\tthis.assertMap(variables);\n\t\t\tthis.assertFunction(serviceResolver);\n\t\t}\n\t\tthis.__variables = variables;\n\t\tthis.__serviceResolver = serviceResolver;\n\t},\n\n\tmembers: {\n\n\t\t__variables: null,\n\t\t__serviceResolver: null,\n\n\t\t// IFormParser implementation\n\n\t\tparseXmlDocument: function(xmlDocument, parentComponent) {\n\t\t\tif(xmlDocument == null)\n\t\t\t\tthrow new Error(\"An XML form must be supplied\");\n\t\t\tvar component = this.__parseStatementBlock(xmlDocument, parentComponent);\n\t\t\tif(component == null)\n\t\t\t\tthrow new Error(\"No Qookery component found within XML document\");\n\t\t\treturn component;\n\t\t},\n\n\t\t// Internal methods\n\n\t\t__parseStatementBlock: function(blockElement, component) {\n\t\t\tif(!qx.dom.Element.hasChildren(blockElement)) return null;\n\t\t\tvar selectionMade = false;\n\t\t\treturn qx.dom.Hierarchy.getChildElements(blockElement).reduce(function(previousResult, statementElement) {\n\n\t\t\t\tvar elementQName = qx.dom.Node.getName(statementElement);\n\t\t\t\tif(elementQName === \"parsererror\")\n\t\t\t\t\tthrow new Error(qx.lang.String.format(\"Parser error in statement block: %1\", [ qx.dom.Node.getText(statementElement) ]));\n\n\t\t\t\tvar namespaces = qookery.util.Xml.getNamespaceDeclarations(statementElement);\n\t\t\t\tvar elementQName = qx.dom.Node.getName(statementElement);\n\t\t\t\tvar elementName = qookery.util.Xml.resolveQName(function(prefix) {\n\t\t\t\t\tif(namespaces != null) {\n\t\t\t\t\t\tvar namespaceUri = namespaces[prefix];\n\t\t\t\t\t\tif(namespaceUri != null)\n\t\t\t\t\t\t\treturn namespaceUri;\n\t\t\t\t\t}\n\t\t\t\t\tif(component != null) {\n\t\t\t\t\t\treturn component.resolveNamespacePrefix(prefix);\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}, elementQName);\n\n\t\t\t\t// First consult the component registry\n\t\t\t\tif(this.constructor.__REGISTRY.isComponentTypeAvailable(elementName)) {\n\t\t\t\t\treturn this.__parseComponent(statementElement, component, elementName, namespaces);\n\t\t\t\t}\n\n\t\t\t\t// Assert that we are within the context of a component\n\t\t\t\tif(component == null)\n\t\t\t\t\tthrow new Error(\"Flow control and other non-component statements must appear with the context of a component\");\n\n\t\t\t\t// Then check a number of special elements known by parser\n\t\t\t\tswitch(elementName) {\n\t\t\t\tcase \"{http://www.qookery.org/ns/Form}else\":\n\t\t\t\t\tif(selectionMade)\n\t\t\t\t\t\treturn previousResult;\n\t\t\t\t\t/* fall through */\n\t\t\t\tcase \"{http://www.qookery.org/ns/Form}if\":\n\t\t\t\t\tselectionMade = this.__parseIfElse(statementElement, component);\n\t\t\t\t\treturn previousResult;\n\t\t\t\tcase \"{http://www.qookery.org/ns/Form}script\":\n\t\t\t\t\tthis.__parseScript(statementElement, component);\n\t\t\t\t\treturn previousResult;\n\t\t\t\tcase \"{http://www.qookery.org/ns/Form}switch\":\n\t\t\t\t\tthis.__parseSwitch(statementElement, component);\n\t\t\t\t\treturn previousResult;\n\t\t\t\tcase \"{http://www.w3.org/2001/XInclude}include\":\n\t\t\t\t\tthis.__parseXInclude(statementElement, component);\n\t\t\t\t\treturn previousResult;\n\t\t\t\t}\n\n\t\t\t\t// Lastly, attempt to delegate element parsing to current component\n\t\t\t\tif(component.parseXmlElement(elementName, statementElement))\n\t\t\t\t\treturn previousResult;\n\n\t\t\t\t// Tough luck with this element, interrupt parser progress here\n\t\t\t\tthrow new Error(qx.lang.String.format(\"Unexpected element '%1' encountered in statement block\", [ elementName ]));\n\n\t\t\t}.bind(this), null);\n\t\t},\n\n\t\t__parseComponent: function(componentElement, parentComponent, componentName, namespaces) {\n\n\t\t\t// Instantiate and initialize new component\n\n\t\t\tvar component = this.constructor.__REGISTRY.createComponent(componentName, parentComponent);\n\t\t\ttry {\n\n\t\t\t\t// Set component attributes\n\n\t\t\t\tvar componentId = qookery.util.Xml.getAttribute(componentElement, \"id\");\n\t\t\t\tif(componentId != null)\n\t\t\t\t\tcomponent.setAttribute(qookery.IComponent.A_ID, componentId);\n\t\t\t\tif(namespaces != null)\n\t\t\t\t\tcomponent.setAttribute(qookery.IComponent.A_NAMESPACES, namespaces);\n\n\t\t\t\t// Additional attributes applicable exclusively to forms\n\n\t\t\t\tif(qx.Class.implementsInterface(component.constructor, qookery.IFormComponent)) {\n\t\t\t\t\tcomponent.setAttribute(qookery.IFormComponent.A_SERVICE_RESOLVER, this.__serviceResolver);\n\t\t\t\t\tcomponent.setAttribute(qookery.IFormComponent.A_VARIABLES, this.__variables);\n\t\t\t\t\tvar translationPrefix = qookery.util.Xml.getAttribute(componentElement, \"translation-prefix\") || componentId;\n\t\t\t\t\tif(translationPrefix != null)\n\t\t\t\t\t\tcomponent.setAttribute(qookery.IFormComponent.A_TRANSLATION_PREFIX, translationPrefix);\n\t\t\t\t}\n\n\t\t\t\t// Register component into its form\n\n\t\t\t\tif(componentId != null && parentComponent != null)\n\t\t\t\t\tparentComponent.getForm().putComponent(componentId, component);\n\n\t\t\t\t// Attribute parsing\n\n\t\t\t\tvar attributes = qookery.util.Xml.parseAllAttributes(component, componentElement);\n\t\t\t\tvar useAttributes = qookery.util.Xml.getAttribute(componentElement, \"use-attributes\");\n\t\t\t\tif(useAttributes != null) useAttributes.split(/\\s+/).forEach(function(variableName) {\n\t\t\t\t\tvar useAttributes = component.getForm().getVariable(variableName);\n\t\t\t\t\tif(!qx.lang.Type.isObject(useAttributes))\n\t\t\t\t\t\tthrow new Error(\"Variable specified in use-attributes not found or of incorrect type\");\n\t\t\t\t\tqx.lang.Object.mergeWith(attributes, useAttributes);\n\t\t\t\t});\n\n\t\t\t\t// Component creation\n\n\t\t\t\tcomponent.create(attributes);\n\n\t\t\t\t// Children parsing\n\n\t\t\t\tthis.__parseStatementBlock(componentElement, component);\n\n\t\t\t\t// Component setup\n\n\t\t\t\tcomponent.setup();\n\n\t\t\t\t// Attach to container\n\n\t\t\t\tif(parentComponent != null) {\n\t\t\t\t\tvar display = qookery.util.Xml.getAttribute(componentElement, \"display\", \"inline\");\n\t\t\t\t\tswitch(display) {\n\t\t\t\t\tcase \"inline\":\n\t\t\t\t\t\tif(!qx.Class.hasInterface(parentComponent.constructor, qookery.IContainerComponent))\n\t\t\t\t\t\t\tthrow new Error(\"Attempted to add a component to a non-container component\");\n\t\t\t\t\t\tparentComponent.add(component);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"none\":\n\t\t\t\t\t\t// Do nothing\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow new Error(\"Unsupported display attribute value\");\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Return new component\n\t\t\t\tvar c = component;\n\t\t\t\tcomponent = null;\n\t\t\t\treturn c;\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\t// Prevent memory leaks in case component creation failed midway\n\t\t\t\tif(component != null)\n\t\t\t\t\tcomponent.dispose();\n\t\t\t}\n\t\t},\n\n\t\t__parseXInclude: function(xIncludeElement, parentComponent) {\n\t\t\tvar formUrl = qookery.util.Xml.getAttribute(xIncludeElement, \"href\", Error);\n\t\t\tformUrl = qookery.util.Xml.parseValue(parentComponent, \"ReplaceableString\", formUrl);\n\t\t\tvar xmlString = qookery.Qookery.getService(\"qookery.IResourceLoader\", true).loadResource(formUrl);\n\t\t\tvar xmlDocument = qx.xml.Document.fromString(xmlString);\n\t\t\tvar formParser = new qookery.internal.FormParser(this.__variables, this.__serviceResolver);\n\t\t\ttry {\n\t\t\t\tvar component = formParser.parseXmlDocument(xmlDocument, parentComponent);\n\t\t\t\tvar xmlIdAttribute = xIncludeElement.attributes[\"xml:id\"];\n\t\t\t\tif(xmlIdAttribute != null)\n\t\t\t\t\tparentComponent.getForm().putComponent(xmlIdAttribute.value, component);\n\t\t\t\treturn component;\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tthis.error(\"Error creating form editor\", e);\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tformParser.dispose();\n\t\t\t}\n\t\t},\n\n\t\t__parseIfElse: function(selectionElement, component) {\n\t\t\tvar expression = qookery.util.Xml.getAttribute(selectionElement, \"expression\");\n\t\t\tif(expression != null) {\n\t\t\t\tvar result = component.evaluateExpression(expression);\n\t\t\t\tif(!result)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar mediaQuery = qookery.util.Xml.getAttribute(selectionElement, \"media-query\");\n\t\t\tif(mediaQuery != null) {\n\t\t\t\tvar query = this.__getMediaQuery(mediaQuery);\n\t\t\t\tif(!query.isMatching())\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar language = qookery.util.Xml.getAttribute(selectionElement, \"{http://www.w3.org/XML/1998/namespace}lang\");\n\t\t\tif(language != null) {\n\t\t\t\tif(qx.locale.Manager.getInstance().getLanguage() != language)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.__parseStatementBlock(selectionElement, component);\n\t\t\treturn true;\n\t\t},\n\n\t\t__parseScript: function(scriptElement, component) {\n\t\t\t// Load source code\n\t\t\tvar sourceCode = qookery.util.Xml.getNodeText(scriptElement);\n\t\t\tvar scriptUrl = qookery.util.Xml.getAttribute(scriptElement, \"source\");\n\t\t\tif(scriptUrl != null)\n\t\t\t\tsourceCode = qookery.Qookery.getService(\"qookery.IResourceLoader\", true).loadResource(scriptUrl);\n\t\t\tif(sourceCode == null)\n\t\t\t\tthrow new Error(\"Empty <script> element\");\n\n\t\t\t// Compile script function\n\t\t\tvar functionConstructorArgs = [ \"$\" ];\n\t\t\tvar argumentNames = qookery.util.Xml.getAttribute(scriptElement, \"arguments\");\n\t\t\tif(argumentNames != null) {\n\t\t\t\tArray.prototype.push.apply(functionConstructorArgs, argumentNames.split(/\\s+/));\n\t\t\t}\n\t\t\telse if(qookery.util.Xml.getAttribute(scriptElement, \"event\") != null) {\n\t\t\t\t// For backward compatibility, add the implied \"event\" argument\n\t\t\t\tfunctionConstructorArgs.push(\"event\");\n\t\t\t}\n\t\t\tfunctionConstructorArgs.push(sourceCode);\n\t\t\tvar scriptFunction; try {\n\t\t\t\tscriptFunction = Function.apply(null, functionConstructorArgs);\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\tthrow new Error(\"Error compiling script '\" + sourceCode.truncate(50) + \"': \" + e.message);\n\t\t\t}\n\n\t\t\t// Preload some XML attributes\n\t\t\tvar actionNames = qookery.util.Xml.getAttribute(scriptElement, \"action\");\n\t\t\tvar functionNames = qookery.util.Xml.getAttribute(scriptElement, \"name\");\n\t\t\tvar eventNames = qookery.util.Xml.getAttribute(scriptElement, \"event\");\n\t\t\tvar mediaQuery = qookery.util.Xml.getAttribute(scriptElement, \"media-query\");\n\t\t\tvar onlyOnce = qookery.util.Xml.getAttribute(scriptElement, \"once\") === \"true\";\n\t\t\tvar preventRecursion = qookery.util.Xml.getAttribute(scriptElement, \"recursion\") === \"prevent\";\n\t\t\tvar debounceMillis = parseInt(qookery.util.Xml.getAttribute(scriptElement, \"debounce\"), 10) || 0;\n\t\t\tvar execute = qookery.util.Xml.getAttribute(scriptElement, \"execute\") === \"true\";\n\t\t\tif(!execute && (actionNames == null && functionNames == null && eventNames == null && mediaQuery == null)) execute = true;\n\n\t\t\t// Create list of target components\n\t\t\tvar componentIds = qookery.util.Xml.getAttribute(scriptElement, \"component\");\n\t\t\tvar components = componentIds == null ? [ component ] :\n\t\t\t\tcomponentIds.split(/\\s+/).map(function(componentId) {\n\t\t\t\t\treturn component.getForm().getComponent(componentId, true);\n\t\t\t\t});\n\n\t\t\t// Apply requested operations to all target components\n\t\t\tcomponents.forEach(function(component) {\n\t\t\t\tvar componentFunction = function() {\n\t\t\t\t\tif(component.isDisposed()) return;\n\t\t\t\t\tif(preventRecursion && componentFunction.__isRunning === true) return;\n\t\t\t\t\tvar scriptArguments = Array.prototype.slice.call(arguments);\n\t\t\t\t\tscriptArguments.unshift(component.getForm().getScriptingContext());\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcomponentFunction.__isRunning = true;\n\t\t\t\t\t\treturn scriptFunction.apply(component, scriptArguments);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(error) {\n\t\t\t\t\t\tqookery.util.Debug.logScriptError(component, scriptFunction.toString(), error);\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\t\t\t\t\tfinally {\n\t\t\t\t\t\tcomponentFunction.__isRunning = false;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif(debounceMillis > 0) {\n\t\t\t\t\tvar debounceFunction = componentFunction;\n\t\t\t\t\tcomponentFunction = function() {\n\t\t\t\t\t\tvar timerId = debounceFunction.__timerId;\n\t\t\t\t\t\tif(timerId != null) {\n\t\t\t\t\t\t\tdebounceFunction.__timerId = null;\n\t\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar bindArguments = [ this ];\n\t\t\t\t\t\tArray.prototype.push.apply(bindArguments, arguments);\n\t\t\t\t\t\tvar setTimoutFunction = Function.prototype.bind.apply(debounceFunction, bindArguments);\n\t\t\t\t\t\tdebounceFunction.__timerId = setTimeout(setTimoutFunction, debounceMillis);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif(mediaQuery != null) {\n\t\t\t\t\tvar query = this.__getMediaQuery(mediaQuery);\n\t\t\t\t\tif(!(execute && onlyOnce)) {\n\t\t\t\t\t\tvar methodName = onlyOnce ? \"addListenerOnce\" : \"addListener\";\n\t\t\t\t\t\tvar listenerId = query[methodName](\"change\", function(data) {\n\t\t\t\t\t\t\tcomponentFunction(data[\"matches\"], data[\"query\"]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tcomponent.addToDisposeList({ dispose: function() {\n\t\t\t\t\t\t\tquery.removeListenerById(listenerId);\n\t\t\t\t\t\t} });\n\t\t\t\t\t}\n\t\t\t\t\tif(execute) componentFunction(query.isMatching(), mediaQuery);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif(functionNames != null) functionNames.split(/\\s+/).forEach(function(functionName) {\n\t\t\t\t\t\tcomponent.getForm().getScriptingContext()[functionName] = componentFunction;\n\t\t\t\t\t});\n\t\t\t\t\tif(actionNames != null) actionNames.split(/\\s+/).forEach(function(actionName) {\n\t\t\t\t\t\tcomponent.setAction(actionName, componentFunction);\n\t\t\t\t\t});\n\t\t\t\t\tif(eventNames != null) eventNames.split(/\\s+/).forEach(function(eventName) {\n\t\t\t\t\t\t// Event handlers are wrapped into try-catch blocks in order to ensure subsequent handlers will be called\n\t\t\t\t\t\tcomponent.addEventHandler(eventName, function(varargs) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tcomponentFunction.apply(component, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcatch(error) {\n\t\t\t\t\t\t\t\tqx.log.Logger.error(component, \"Event handler \", eventName, \" error:\", error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, onlyOnce);\n\t\t\t\t\t});\n\t\t\t\t\tif(execute) componentFunction();\n\t\t\t\t}\n\t\t\t}, this);\n\t\t},\n\n\t\t__parseSwitch: function(switchElement, component) {\n\t\t\tif(!qx.dom.Element.hasChildren(switchElement)) return;\n\t\t\tvar switchExpression = qookery.util.Xml.getAttribute(switchElement, \"expression\", Error);\n\t\t\tvar switchResult = component.evaluateExpression(switchExpression);\n\t\t\tvar children = qx.dom.Hierarchy.getChildElements(switchElement);\n\t\t\tfor(var i = 0; i < children.length; i++) {\n\t\t\t\tvar caseElement = children[i];\n\t\t\t\tvar elementName = qx.dom.Node.getName(caseElement);\n\t\t\t\tif(elementName !== \"case\")\n\t\t\t\t\tthrow new Error(qx.lang.String.format(\"Unexpected element in switch block: %1\", [ qx.dom.Node.getText(switchElement) ]));\n\t\t\t\tvar caseExpression = qookery.util.Xml.getAttribute(caseElement, \"expression\");\n\t\t\t\tif(caseExpression != null) {\n\t\t\t\t\tvar caseResult = component.evaluateExpression(caseExpression);\n\t\t\t\t\tif(caseResult != switchResult) continue;\n\t\t\t\t}\n\t\t\t\tthis.__parseStatementBlock(caseElement, component);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\t__getMediaQuery: function(mediaQuery) {\n\t\t\tvar query = this.constructor.__REGISTRY.getMediaQuery(mediaQuery);\n\t\t\tif(query != null)\n\t\t\t\treturn query;\n\t\t\treturn new qx.bom.MediaQuery(mediaQuery);\n\t\t}\n\t}\n});\n"
  ]
}